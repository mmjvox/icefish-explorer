
void RDirectoryModel::applyCurrentDirectorySettings(QDir *localDirectory){

    localDirectory->setSorting(QDir::DirsFirst | QDir::Name);

    QFile dirInfo(localDirectory->path() + "/.rfmDirectorySetting");
    if(dirInfo.open(QIODevice::ReadOnly)){
        QTextStream stream(&dirInfo);
        QString info;

        do {
            info = stream.readLine();
        if(info.startsWith("CurrentView")){
                info = info.section('=', 1);
                if(info.startsWith("00"))
                    emit changeFileFolderView(0);
                else if(info.startsWith("01"))
                    emit changeFileFolderView(1);
            }
        }while (!info.isNull());
    }
    emit SortingPreferenceChanged();
}

void RDirectoryModel::updateSettingsForCurrentDirectory(QString fileOperation, QString newValue){
    QString currentDirectory = addressBoxData;
    QFile settingFile(currentDirectory + "/.rfmDirectorySetting");

    if(settingFile.open(QIODevice::ReadOnly)){
        QByteArray wholeSetting = settingFile.readAll();

        int indexOfSettingValue = wholeSetting.indexOf(fileOperation);
        int nextNewline = wholeSetting.indexOf('\n', indexOfSettingValue);
        nextNewline -= wholeSetting.indexOf('=', indexOfSettingValue);

        if(indexOfSettingValue > 0)
            wholeSetting.replace(indexOfSettingValue + fileOperation.length() + 1,
                                 nextNewline, newValue.toUtf8() + '\n');
        else
            wholeSetting.append(fileOperation + "=" + newValue + "\n");

        settingFile.close();
        if(settingFile.open(QIODevice::WriteOnly | QIODevice::Truncate)){
            settingFile.write(wholeSetting);
            settingFile.close();
        }
    }
    else if(settingFile.open(QIODevice::WriteOnly)) {
        settingFile.write("[Settings]\n");
        settingFile.write((fileOperation + "=" + newValue + "\n").toUtf8());
        settingFile.close();
    }
}
